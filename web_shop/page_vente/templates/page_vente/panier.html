{% extends 'page_vente/base.html' %}
{% load static %}
{% block header %}
<h1 id="title_cart">Votre panier</h1>
{% endblock %}
{% block description %}
{% endblock %}
{% block content %}
<section class="cart-container">
    {% if items %}
    <button class="align-items-center page-button float-right" id="clear_cart" onclick="clearCart()">Vider le panier</button>
        {% if expiration_date %}
            <p ><span id="expiration_date">‚ö†Ô∏è Votre panier expirera le </span>{{ expiration_date|date:"d/m/Y H:i" }}.</p>
        {% else %}
            <p id="expiration_soon">‚ö†Ô∏è Votre panier expirera bient√¥t.</p>
        {% endif %}
    <div class="grid-container">
        
        <ul class="product-list-cart" id="liste-articles"></ul>
        <aside class="text-center">
            <h2 id="payment_title">Paiement s√©curis√©</h2>

            <p><span id="shipping_cost">‚úÖ Les frais de port sont fixes √† 5 ‚Ç¨</span> <span id="insurance_25_euros">et incluent une assurance jusqu'√† 25 ‚Ç¨ </span><span id="with_our_partner_mondial_relay">via notre partenaire Mondial Relay.</span></p>
          
            <p id="mandatory-insurance" class="hidden"><span id="mandatory_insurance_2">üö® Une assurance obligatoire de </span><span id="mandatory-insurance-cost">0</span><span id="mandatory_insurance_3"> ‚Ç¨ (montant variable selon le montant de la commande. Plus d'information sur la page <a href="/cgv" target="_blank">CGV</a>) sera ajout√©e pour les commandes comprise entre  50 ‚Ç¨ et  500 ‚Ç¨.</span><span id="mandatory_insurance_4"><br><br>‚ö†Ô∏è L'indemnisation forfaitaire maximal est de 500 ‚Ç¨‚ö†Ô∏è</span></p>
            <div class="separator"></div>
            <p id="total_articles"><span id="total_articles_title">Total des articles : </span><span id="order-total">{{total | floatformat:2 }}</span> ‚Ç¨</p>
            <p id="shipping_cost_short">Frais de port : <span id="shipping-cost">5.00 ‚Ç¨</span></p>
            
            <p id="insurance"><span id="insurance_cost">Assurance : </span><span id="insurance-cost">0.00</span> ‚Ç¨<span id="insurance_25_euros_2" ><br>Inclue (jusqu'√† 25 ‚Ç¨)</span></p>
            <div id="insurance-option" class="hidden">
                <input type="checkbox" id="add-insurance" onchange="updateTotal()"> 
                <label for="add-insurance" id="add-insurance-label">Assurer la totalit√© de la valeur des produits (+2,00 ‚Ç¨)</label>
            </div>
            <div class="separator"></div>
            <p><span id="total_amount_title">Total de la commande : </span><span id="total-amount">0</span> ‚Ç¨</p>
            <div>
              <input type="checkbox" id="accept-cgv"> 
              <label for="accept-cgv" ><span id="accept-cgv-label">J'accepte les <a href="/cgv" target="_blank">conditions g√©n√©rales de vente</a>.</span>(v{{ latest_cgv.version }})</label>
            </div>
            <button class="page-button" id="checkout" onclick="handleCheckout()">Payer via Stripe</button>
          
            <p id="error-message" class="error hidden">Vous devez accepter les CGV pour continuer.</p>
        </aside>
    
    
    </div>
        {% if expiration_date %}
            <p ><span id="expiration_date">‚ö†Ô∏è Votre panier expirera le </span>{{ expiration_date|date:"d/m/Y H:i" }}.</p>
        {% else %}
            <p id="expiration_soon">‚ö†Ô∏è Votre panier expirera bient√¥t.</p>
        {% endif %}

    {% endif %}
</section>
<section id="empty-section">
    <p id="empty_cart">Votre panier est vide.</p>
</section>

<div id="modal">
    <h3 class="text-center" id="nom-article"></h3>
    <button id="close-button" type="button" onclick="closeModal()">&times;</button>
    <div class="grid-container">
        <div class="product-info">
            <h4 id="info-description">Description :</h4>
            <p id="description-article"></p>
            <h4 id="info-price">Prix :</h4>
            <p id="prix-article"></p>
        </div>
        <div class="image-container">
            <img id="current-image" src="" alt="Image du produit">
            <div class="image-buttons">
                <button id="prev-button" type="button" onclick="changeImage(-1)">Pr√©c√©dent</button>
                <button id="next-button" type="button" onclick="changeImage(1)">Suivant</button>
            </div>
        </div>
    </div>
</div>
    


    
</div>
{% endblock %}